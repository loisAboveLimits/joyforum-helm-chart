replicaCount: 2

image:
  repository: acrselabyoruat.azurecr.io/joyforum
  tag: latest
  pullPolicy: IfNotPresent

# No imagePullSecrets required; AKS manages ACR auth externally
imagePullSecrets: []

service:
  type: LoadBalancer
  port: 80
  annotations:
    service.beta.kubernetes.io/azure-load-balancer-internal: "true"  # Required for internal LB on AKS

ingress:
  enabled: false  # Disabled since using internal LoadBalancer

# ingress:
#   enabled: false
#   className: nginx
#   annotations: {}
#   hosts:
#     - host: your-public-domain.com
#       paths:
#         - /

env: []

deployment:
  revisionHistoryLimit: 5
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxUnavailable: 25%
      maxSurge: 25%

resources: {}

serviceAccount:
  create: true
  name: jormfarm-workload-identity-sa
  automount: true
  annotations: {}

externalSecrets:
  enabled: true
  secretStore:
    name: wordpress-azure-kv-store
    azureKeyVaultName: kv-csi-joyforum-xbuns
    serviceAccountName: jormfarm-workload-identity-sa
  secrets:
    - name: wordpress-db-secret
      refreshInterval: 10m
      data:
        - secretKey: WORDPRESS_DB_USER
          remoteRefKey: MySQLServerAdminUsername
        - secretKey: WORDPRESS_DB_PASSWORD
          remoteRefKey: MySQLServerAdminPassword
        - secretKey: WORDPRESS_DB_HOST
          remoteRefKey: mysql-host # We'll override in env var, but keep for completeness
        - secretKey: WORDPRESS_DB_NAME
          remoteRefKey: joyforum_db  # Assuming DB name is static
